{"componentChunkName":"component---src-templates-project-details-js","path":"/projects/chatbot-openai/","result":{"data":{"markdownRemark":{"html":"<h2>Building a custom Q&#x26;A chatbot with supabase and openAI model</h2>\n<blockquote>\n<p><a href=\"https://supabase.com/\">Supabase</a> - an open-source database infrastructure built on PostgreSQL.</p>\n<p><a href=\"https://platform.openai.com/docs/models\">OpenAI Models</a> - models used here are <code>gpt-4</code> and <code>text-embedding-ada-002</code></p>\n</blockquote>\n<br>\n<p>A Supabase and OpenAI system is built, that allows to call an API endpoint with a question, and then generate an answer based on the custom data provided. This is done by using PostgreSQL vector storage, Supabase Edge functions, and OpenAI Embeddings. A supabase and OpenAI account is required.\n<br></p>\n<h3>Create a .txt file with custom data</h3>\n<p>Data about a fake person named Anitha is stored in .txt file, it's then turned into an embedding using the model  <code>text-embedding-ada-002</code>.Embeddings are stored in supabase vector.</p>\n<br>\n<table>\n<thead>\n<tr>\n<th align=\"left\">id</th>\n<th align=\"left\">content</th>\n<th align=\"left\">embedding</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\">1</td>\n<td align=\"left\">Anitha grew up in a small town in Kerala.</td>\n<td align=\"left\">[0.019696854, 0.00064515544, 2.64515544]</td>\n</tr>\n<tr>\n<td align=\"left\">2</td>\n<td align=\"left\">After excelling in math and science classes in high school.</td>\n<td align=\"left\">[0.0019600854, 0.01064515544, 0.64515544]</td>\n</tr>\n</tbody>\n</table>\n<br>\n<br>\n<h3>Define an API end point</h3>\n<p>A post endpoint is defined to receive questions in the request body. The questions are then converted into embeddings.\n<br></p>\n<h3>Supabase Edge function gets called with question and use match_documents function</h3>\n<p><code>match_documents</code> returns an array of matching documents to the question.Then loop through the array of documents, format them for chatgpt promt.<code>gpt-4</code> model is used.</p>\n<pre><code>  const completionResponse = await openai.chat.completions.create({\n    messages:[{\n        role: \"system\",\n        content: `You are a happy and helpful assistant named Poppy.Who answers qustions based on the context sections\n        ${matching_documents_array}`,\n      },\n    { role: \"user\", content: \"&#x3C;question from user>? },],\n     model: \"gpt-4\",\n    })\n</code></pre>\n<br>\n<br>\n<h3>Finally return the response from the model to user through a response</h3>\n<img src=\"https://github.com/AngelMathew/chatbotApi/assets/30999892/a499ec5a-0b00-47a9-8bc3-2ae78df6c0cf\" alt=\"api end point\" width=\"100%\">\n<p>Source code</p>\n<pre><code>https://github.com/AngelMathew/chatbotApi.git\n</code></pre>","frontmatter":{"stack":"genAI","title":"Custom data chatbot","summary":"A Supabase and OpenAI system, that allows to call an API endpoint with a question, and then generate an answer based on the custom data provided","featuredImg":{"childImageSharp":{"fluid":{"base64":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAABQD/xAAVAQEBAAAAAAAAAAAAAAAAAAACAf/aAAwDAQACEAMQAAABMTNTNMnIP//EABkQAAIDAQAAAAAAAAAAAAAAAAEDAAIRE//aAAgBAQABBQIDYaUujIoxluKE4Vf/xAAVEQEBAAAAAAAAAAAAAAAAAAAAEf/aAAgBAwEBPwFX/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAECMRAREiH/2gAIAQEABj8CK9WdwuZF8o//xAAcEAADAAEFAAAAAAAAAAAAAAAAAREhMVFhodH/2gAIAQEAAT8hWknJWqE3Hg8zoIS3ott2FOq1sf/aAAwDAQACAAMAAAAQ9C//xAAXEQADAQAAAAAAAAAAAAAAAAAAAREx/9oACAEDAQE/EG8JP//EABYRAQEBAAAAAAAAAAAAAAAAAAEAEf/aAAgBAgEBPxALEv/EABwQAQADAAMBAQAAAAAAAAAAAAEAESExQWGhwf/aAAgBAQABPxBVoNA84l5F8VpXF9hc8mzYrWFqi/S/yCMn7GFtDM9BvOpl/J//2Q==","aspectRatio":1.5037593984962405,"src":"/static/b051bb4a38a533a212a4101fe174fafb/14b42/projectImageOne.jpg","srcSet":"/static/b051bb4a38a533a212a4101fe174fafb/f836f/projectImageOne.jpg 200w,\n/static/b051bb4a38a533a212a4101fe174fafb/2244e/projectImageOne.jpg 400w,\n/static/b051bb4a38a533a212a4101fe174fafb/14b42/projectImageOne.jpg 800w,\n/static/b051bb4a38a533a212a4101fe174fafb/47498/projectImageOne.jpg 1200w,\n/static/b051bb4a38a533a212a4101fe174fafb/0e329/projectImageOne.jpg 1600w,\n/static/b051bb4a38a533a212a4101fe174fafb/9eda0/projectImageOne.jpg 4896w","sizes":"(max-width: 800px) 100vw, 800px"}}}}}},"pageContext":{"slug":"chatbot-openai"}},"staticQueryHashes":["2052298874"],"slicesMap":{}}